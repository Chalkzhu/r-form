!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("form-render"),require("react-dnd"),require("react-dnd-html5-backend"),require("classnames"),require("antd"),require("@ant-design/icons"),require("antd/es/date-picker/locale/zh_CN")):"function"==typeof define&&define.amd?define(["exports","react","form-render","react-dnd","react-dnd-html5-backend","classnames","antd","@ant-design/icons","antd/es/date-picker/locale/zh_CN"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).bundle={},e.react,e.FormRender,e["react-dnd"],e["react-dnd-html5-backend"],e.cn,e.antd,e["@ant-design/icons"],e.locale)}(this,(function(e,t,r,n,a,l,d,o,i){"use strict";function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c=u(t),s=u(r),f=u(l),m=u(i);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(){return b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b.apply(this,arguments)}function E(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,l=[],d=!0,o=!1;try{for(r=r.call(e);!(d=(n=r.next()).done)&&(l.push(n.value),!t||l.length!==t);d=!0);}catch(e){o=!0,a=e}finally{try{d||null==r.return||r.return()}finally{if(o)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var v=t.createContext(),x=function(){return t.useContext(v)},Q=o.createFromIconfontCN({scriptUrl:"//at.alicdn.com/t/font_2966019_macdonzji9j.js"}),N=["readonly","default"],j=function(e){var t=g({placeholder:"请输入",disabled:e.readonly,value:e.default},E(e,N));return c.default.createElement(d.Input,t)},S=["readonly"],B=function(e){var t=g({placeholder:"请输入",disabled:e.readonly},E(e,S));return c.default.createElement(d.Input.TextArea,t)},F=["readonly","style"],w=function(e){var t=e.readonly,r=e.style,n=E(e,F),a=g({placeholder:"请输入",disabled:t,style:g({width:"100%"},r)},n);return c.default.createElement(d.InputNumber,a)},D=["options","readonly"],k=function(e){var t=e.options,r=g({showSearch:!0,allowClear:!0,placeholder:"请选择",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},disabled:e.readonly},E(e,D));return c.default.createElement(c.default.Fragment,null,c.default.createElement(d.Select,r,null==t?void 0:t.map((function(e){return c.default.createElement(d.Select.Option,{key:e.value,value:e.value,disabled:e.readonly},e.label)}))))},O=["options","readonly"],L=function(e){var t=e.options,r=g({disabled:e.readonly},E(e,O));return c.default.createElement(d.Radio.Group,r,c.default.createElement(d.Space,{wrap:!0},null==t?void 0:t.map((function(e){return c.default.createElement(d.Radio,{key:e.value,value:e.value},e.label)}))))},U=["options","readonly"],C=function(e){var t=e.options,r=g({disabled:e.readonly},E(e,U));return c.default.createElement(d.Checkbox.Group,r,c.default.createElement(d.Space,{wrap:!0},null==t?void 0:t.map((function(e){return c.default.createElement(d.Checkbox,{key:e.value,value:e.value},e.label)}))))},R=["readonly","type","dateType","style"],I=function(e){var t=e.readonly,r=e.type,n=void 0===r?"date":r,a=e.dateType,l=void 0===a?"date":a,o=e.style,i=E(e,R),u=g({disabled:t,style:g({width:"100%"},o),locale:m.default,picker:l},i);return c.default.createElement(c.default.Fragment,null,function(){switch(n){case"date":return c.default.createElement(d.DatePicker,u);case"range":return c.default.createElement(d.DatePicker.RangePicker,u)}}())},P=["$id","widget","enum","enumNames","disabled","props"],q=function(e){var r=x(),a=r.columns,l=r.onChange,i=r.onSetting,u=e.width;e.name;var s=e.$id,m=e.required,p=e.title,y=e.description,h=e.seq,v=function(e){e.$id;var r=e.widget,n=e.enum,a=e.enumNames,l=e.disabled,d=e.props,o=E(e,P),i=x().widgets,u=t.useMemo((function(){return(null==n?void 0:n.map((function(e,t){return{label:a[t],value:e}})))||[]}),[a,n]),s={input:c.default.createElement(j,b({readonly:l},d,o)),textarea:c.default.createElement(B,b({readonly:l},d)),number:c.default.createElement(w,b({readonly:l},d)),select:c.default.createElement(k,b({options:u,readonly:l},d,o)),date:c.default.createElement(I,b({type:"date",readonly:l},d)),dateRange:c.default.createElement(I,b({type:"range",readonly:l},d)),checkbox:c.default.createElement(C,b({options:u,readonly:l},d)),checkboxes:c.default.createElement(C,b({options:u,readonly:l},d)),radio:c.default.createElement(L,b({options:u,readonly:l},d))};return s[r]?s[r]:i[r](e)}(e),N=t.useRef(null),S=_(n.useDrop({accept:"editFormItem",collect:function(e){return{handlerId:e.getHandlerId()}},hover:function(e,t){var r;if(N.current){var n=e.index,d=h;if(n!==d){var o=null===(r=N.current)||void 0===r?void 0:r.getBoundingClientRect(),i=(o.bottom-o.top)/2,u=t.getClientOffset().y-o.top;n<d&&u<i||n>d&&u>i||(!function(e,t){var r=a.map((function(r){return g(g({},r),{},{seq:r.seq===e?t:r.seq===t?e:r.seq})}));l(r,"drop")}(n,d),e.index=d)}}}}),2),F=S[0].handlerId,D=S[1],O=_(n.useDrag({type:"editFormItem",item:function(){return{index:h}},collect:function(e){return{isDragging:e.isDragging()}}}),3),U=O[0].isDragging,R=O[1],q=O[2];return D(N),c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{ref:N,"data-handler-id":F,style:{width:u},className:"drag_col"},c.default.createElement("div",{ref:q,className:f.default("drag_item",{active:U})},c.default.createElement("div",{className:"drag_header"},c.default.createElement("div",{className:"drag_header_title"},m&&c.default.createElement("span",{className:"require"},"*"),p,y&&c.default.createElement(d.Tooltip,{title:y},c.default.createElement(o.QuestionCircleOutlined,null))),c.default.createElement("div",{className:"drag_header_extend"},c.default.createElement(Q,{type:"lmweb-setting",onClick:function(){return null==i?void 0:i(e)}}),c.default.createElement(Q,{type:"lmweb-delete",onClick:function(){var e=a.filter((function(e){return e.$id!==s}));l(e,"delete")}}),c.default.createElement(Q,{ref:R,type:"lmweb-drag"}))),c.default.createElement("div",{className:"drag_body"},v))))};!function(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===r&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}(".form_json_edit .ant-form-item{margin-bottom:0}.form_json_edit .drag_box{display:flex;flex-flow:row wrap;margin:-8px}.form_json_edit .drag_box .drag_col{display:block;max-width:100%;min-height:1px;padding:8px}.form_json_edit .drag_box .drag_item{border:1px dashed transparent;background-color:#f5f5f5;padding:16px;transition:.3s}.form_json_edit .drag_box .drag_item.active{border-color:#1890fc}.form_json_edit .drag_box .drag_item .drag_header{display:flex;align-items:center;justify-content:space-between}.form_json_edit .drag_box .drag_item .drag_header .drag_header_title{display:inline-flex;align-items:center}.form_json_edit .drag_box .drag_item .drag_header .drag_header_title .require{color:#fa4f53}.form_json_edit .drag_box .drag_item .drag_header .drag_header_title .anticon{margin-left:4px}.form_json_edit .drag_box .drag_item .drag_header .drag_header_extend{display:flex;align-items:center;font-size:18px;color:#1890fc}.form_json_edit .drag_box .drag_item .drag_header .drag_header_extend .anticon{margin:0 8px;cursor:pointer}.form_json_edit .drag_box .drag_item .drag_body{display:flex;align-items:center;min-height:32px;margin-top:8px}.form_json_edit .drag_box .drag_item .drag_body>div{width:100%}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9pbmRleC5sZXNzIiwiaW5kZXgubGVzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwrQkFHSSxlQ0RKLENERkEsMEJBT0ksWUFBQSxDQUNBLGtCQUFBLENBQ0EsV0NGSixDRFBBLG9DQVlNLGFBQUEsQ0FDQSxjQUFBLENBQ0EsY0FBQSxDQUNBLFdDRk4sQ0RiQSxxQ0FtQk0sNkJBQUEsQ0FDQSx3QkFBQSxDQUNBLFlBQUEsQ0FDQSxjQ0hOLENES00sNENBQ0Usb0JDSFIsQ0R0QkEsa0RBNkJRLFlBQUEsQ0FDQSxrQkFBQSxDQUNBLDZCQ0pSLENEM0JBLHFFQWtDVSxtQkFBQSxDQUNBLGtCQ0pWLENEL0JBLDhFQXNDWSxhQ0paLENEbENBLDhFQTBDWSxlQ0xaLENEckNBLHNFQStDVSxZQUFBLENBQ0Esa0JBQUEsQ0FDQSxjQUFBLENBQ0EsYUNQVixDRDNDQSwrRUFxRFksWUFBQSxDQUNBLGNDUFosQ0QvQ0EsZ0RBNERRLFlBQUEsQ0FDQSxrQkFBQSxDQUNBLGVBQUEsQ0FDQSxjQ1ZSLENEWVEsb0RBQ0UsVUNWViIsImZpbGUiOiJpbmRleC5sZXNzIn0= */");Object.defineProperty(e,"useForm",{enumerable:!0,get:function(){return r.useForm}}),e.FormJsonEdit=function(e){var t,r=e.columns,l=e.onChange,d=e.widgets,o=e.onSetting;return c.default.createElement("div",{className:"form_json_edit"},c.default.createElement(v.Provider,{value:{columns:r,onChange:l,widgets:d,onSetting:o}},c.default.createElement(n.DndProvider,{backend:a.HTML5Backend},c.default.createElement("div",{gutter:[16,16],className:"drag_box"},null==r||null===(t=r.sort((function(e,t){return(null==e?void 0:e.seq)-(null==t?void 0:t.seq)})))||void 0===t?void 0:t.map((function(e){return c.default.createElement(q,b({key:e.$id},e))}))))))},e.default=function(e){return c.default.createElement(c.default.Fragment,null,c.default.createElement(s.default,e))},Object.defineProperty(e,"__esModule",{value:!0})}));
